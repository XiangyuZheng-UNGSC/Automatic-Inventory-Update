name: 自动处理新的 Excel 文件

# 1. 触发条件
on:
  push:
    branches:
      - main # 监控 main 分支
    paths:
      - 'data/**/*.xlsx' # 核心秘诀：只有当 data 文件夹下的 .xlsx 文件被新增或修改时，才触发！
      - 'data/**/*.xls'  # 兼容老版本的 Excel 格式

jobs:
  run-python-script:
    runs-on: ubuntu-latest 
    
    steps:
      - name: 1. 检出代码 (把你的文件下载到云端服务器)
        uses: actions/checkout@v4
        
      - name: 2. 安装 Python 环境
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          
      - name: 3. 安装必要的 Python 库 (例如处理 Excel 常用的库)
        run: |
          python -m pip install --upgrade pip
          pip install pandas openpyxl # 如果你的脚本用到这些库，必须在这里安装
          
      - name: 4. 执行你的 Python 脚本
        run: python process_data.py
